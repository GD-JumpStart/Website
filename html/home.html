<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>JumpStart</title>
        <link rel="stylesheet" href="/assets/css/home.css">
		
		<link rel="apple-touch-icon" sizes="180x180" href="/assets/manifest/apple-touch-icon.png">
		<link rel="icon" type="image/png" sizes="32x32" href="/assets/manifest/favicon-32x32.png">
		<link rel="icon" type="image/png" sizes="16x16" href="/assets/manifest/favicon-16x16.png">
		<link rel="manifest" href="/assets/manifest/site.webmanifest">
    <body>
        <main>
            <center style="height: 100%; flex-direction: column;">
                <img id="icon" src="/assets/img/icon.svg" width="100" height="100" style="transform: translateY(60px); opacity: 0; transition: 400ms ease-out" alt="JumpStartLogo">
                <loading id="load" style="position: absolute; bottom: calc(50% - 70px); opacity: 0"></loading>
                <h2 style="margin: 10px 0px; transform: translateY(10px); opacity: 0; transition: 200ms ease-out">Welcome to JumpStart.</h2>
                <p style="transform: translateY(10px); opacity: 0; transition: 200ms ease-out">All your tools for Geometry Dash, all in one spot.</p>
                <div style="transform: translateY(10px); opacity: 0; transition: 200ms ease-out" id="actions"><button class="style" onclick="location.href = 'https:\/\/github.com/GD-JumpStart/Application/releases/'">Download</button><button class="style" onclick="location.href = 'https:\/\/github.com/GD-JumpStart/'">Learn More</button></p>
            </center>
        </main>
    </body>
        
    <script>
        const wait = ms => new Promise(resolve => setTimeout(resolve, ms))
        
        window.addEventListener('load', async () => {
            await wait(500)
            document.getElementById('icon').style.transform = 'translateY(50px)'
            document.getElementById('icon').style.opacity = '1'
            await wait(300)

            await new Promise(async resolve => {
                document.getElementById('load').style.opacity = '1'
                await wait(300)
                if (navigator.appVersion.toLowerCase().indexOf('mac') != -1) document.querySelectorAll('center div button')[0].innerText = 'Download for MacOS'
                else if (navigator.appVersion.toLowerCase().indexOf('win') != -1) document.querySelectorAll('center div button')[0].innerText = 'Download for Windows'
                else document.querySelectorAll('center div button')[0].innerHTML = 'Download for Windows <span class="popup"><i class="bi bi-exclamation-circle"></i><p class="content">OS not currently supported</p></span>'
                await new Promise(resolve => {
                    fetch('https://api.github.com/repos/GD-JumpStart/Application/releases', {
                        headers: {
                            'User-Agent': navigator.userAgent
                        }
                    }).then(res => { return res.json() }).then(res => {
                         let suffix = navigator.appVersion.toLowerCase().indexOf('mac') != -1 ? 'mac' : 'win'
                        for (let i = 0; i < res.length; i++) {
                            console.log(res[i].tag_name.toLowerCase(), res[i].tag_name.toLowerCase().endsWith(`-${suffix}`))
                            if (res[i].tag_name.toLowerCase().endsWith(`-${suffix}`)) {
                                document.querySelectorAll('center div button')[0].onclick = () => location.href = `https://github.com/GD-JumpStart/Application/releases/download/${res[i].tag_name}/${suffix == 'mac' ? 'JumpStart.zip' : 'JumpStart_Setup.exe'}`
                                break
                            }
                        }
                        resolve()
                    })
                })
                document.getElementById('load').style.opacity = '0'
                await wait(300)
                resolve()
            })

            document.getElementById('icon').style.transform = 'translateY(-10px) rotate(15deg)';

            await wait(500)
            document.querySelector('center h2').style.transform = 'translateY(0px)'
            document.querySelector('center h2').style.opacity = '1'
            await wait(100)
            document.querySelector('center p').style.transform = 'translateY(0px)'
            document.querySelector('center p').style.opacity = '1'
            await wait(100)
            document.querySelector('center div').style.transform = 'translateY(0px)'
            document.querySelector('center div').style.opacity = '1'
        })
    </script>
        
</html>